# XPC4001: Handler method not found

## Severity

Error

## Description

This rule reports when the handler method referenced in a `RegisterStep()` call does not exist on the specified service type. The source generator validates that the method exists to ensure the plugin will work correctly at runtime.

## ❌ Example of violation

```csharp
public class AccountPlugin : Plugin
{
    public AccountPlugin()
    {
        // XPC4001: Method 'HandleUpdate' not found on service type 'IAccountService'
        RegisterStep<Account, IAccountService>(
            EventOperation.Update,
            ExecutionStage.PostOperation,
            nameof(IAccountService.HandleUpdate))  // Method doesn't exist!
            .WithPreImage(x => x.Name);
    }
}

public interface IAccountService
{
    void Process();  // Only has 'Process', not 'HandleUpdate'
}
```

## ✅ How to fix

Add the missing method to the service interface:

```csharp
public class AccountPlugin : Plugin
{
    public AccountPlugin()
    {
        RegisterStep<Account, IAccountService>(
            EventOperation.Update,
            ExecutionStage.PostOperation,
            nameof(IAccountService.HandleUpdate))
            .WithPreImage(x => x.Name);
    }
}

public interface IAccountService
{
    void HandleUpdate(PreImage preImage);  // Method now exists with correct signature
}
```

Or update the registration to reference an existing method:

```csharp
public class AccountPlugin : Plugin
{
    public AccountPlugin()
    {
        RegisterStep<Account, IAccountService>(
            EventOperation.Update,
            ExecutionStage.PostOperation,
            nameof(IAccountService.Process))  // Reference the existing method
            .WithPreImage(x => x.Name);
    }
}

public interface IAccountService
{
    void Process(PreImage preImage);
}
```

## Why this matters

1. **Compile-time safety**: This error catches typos and missing methods at compile time rather than runtime
2. **Code generation**: The source generator cannot generate type-safe wrapper classes when the handler method doesn't exist
3. **Runtime failures**: If this error is ignored (e.g., by using a string literal), the plugin will fail at runtime when it attempts to invoke the non-existent method

## Code fix available

Visual Studio and other IDEs supporting Roslyn analyzers will offer a code fix to create the missing method on the service interface with the correct signature based on any registered images.

## See also

- [XPC3001: Prefer nameof over string literal](XPC3001.md)
- [XPC4002: Handler signature does not match registered images](XPC4002.md)
